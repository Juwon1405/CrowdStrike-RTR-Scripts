function ConvertFrom-Json20([object] $item){add-type -assembly system.web.extensions;$ps_js=new-object system.web.script.serialization.javascriptSerializer;return ,$ps_js.DeserializeObject($item)};$output = 'User, Extension Name, Version' + [System.Environment]::NewLine;$users = Get-ChildItem c:\users | ?{ $_.PSIsContainer };foreach ($user in $users){$extpath = 'c:\users\' + $user + '\appdata\local\Google\Chrome\User Data\Default\Extensions\*\*\manifest.json';$extensions = Get-ChildItem $extpath -ErrorAction SilentlyContinue; foreach ($extension in $extensions){$content = Get-Content $extension.FullName -Raw;$json = $content | ConvertFrom-JSON;if (-Not ($json.name -like '__msg_*')){$output += $user.Name + ', ' + $json.name + ', ' + $json.version + [System.Environment]::NewLine};};};$output;
# Delete this line and the comment hashes to have this export the contents to the host.
# | Export-Csv -Path "c:\$env:COMPUTERNAME-chromeExtensions.csv" -NoTypeInformation
